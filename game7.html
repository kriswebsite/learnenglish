<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guess the Picture Game</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Custom Styles (Optional) -->
    <!-- If you want to include any custom styles, you can link them here -->
    <!-- <link rel="stylesheet" href="styles.css"> -->
</head>
<body class="bg-gray-100">

    <!-- Navigation Bar -->
    <nav class="bg-gray-800 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Brand -->
                <div class="flex-shrink-0">
                    <a href="index.html" class="text-xl font-bold">Learn and Play</a>
                </div>
                <!-- Hamburger Menu (Mobile) -->
                <div class="flex lg:hidden">
                    <button id="navbar-toggle" class="text-gray-300 hover:text-white focus:outline-none focus:text-white">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
                <!-- Menu -->
                <div class="hidden lg:block">
                    <ul class="flex space-x-4">
                        <li><a href="intro.html" class="hover:bg-gray-700 px-3 py-2 rounded-md">Lessons</a></li>
                        <li class="relative group">
                            <button class="flex items-center hover:bg-gray-700 px-3 py-2 rounded-md">
                                Games
                                <svg class="ml-1 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"/>
                                </svg>
                            </button>
                            <!-- Dropdown Menu -->
                            <ul class="absolute left-0 mt-2 w-40 bg-gray-700 rounded-md shadow-lg hidden group-hover:block">
                                <li><a href="game1.html" class="block px-4 py-2 hover:bg-gray-600">Game 1</a></li>
                                <li><a href="game2.html" class="block px-4 py-2 hover:bg-gray-600">Game 2</a></li>
                                <li><a href="game3.html" class="block px-4 py-2 hover:bg-gray-600">Game 3</a></li>
                                <li><a href="game4.html" class="block px-4 py-2 hover:bg-gray-600">Game 4</a></li>
                                <li><a href="game5.html" class="block px-4 py-2 hover:bg-gray-600">Game 5</a></li>
                                <li><a href="game7.html" class="block px-4 py-2 hover:bg-gray-600">Game 7</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="navbar-menu" class="lg:hidden hidden bg-gray-800">
            <ul class="px-2 pt-2 pb-3 space-y-1">
                <li><a href="intro.html" class="block px-3 py-2 rounded-md hover:bg-gray-700">Lessons</a></li>
                <li class="relative">
                    <button class="w-full text-left px-3 py-2 rounded-md hover:bg-gray-700 flex items-center justify-between">
                        Games
                        <svg class="h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"/>
                        </svg>
                    </button>
                    <!-- Dropdown Menu -->
                    <ul class="mt-1 space-y-1 pl-4">
                        <li><a href="game1.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 1</a></li>
                        <li><a href="game2.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 2</a></li>
                        <li><a href="game3.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 3</a></li>
                        <li><a href="game4.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 4</a></li>
                        <li><a href="game5.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 5</a></li>
                        <li><a href="game7.html" class="block px-3 py-2 rounded-md hover:bg-gray-600">Game 7</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Game Container -->
    <div id="root" class="p-4 sm:p-8"></div>

    <!-- JavaScript for Navbar Toggle -->
    <script>
        /**
         * Function to toggle the mobile navbar menu.
         */
        function toggleNavbarMenu() {
            const navbarMenu = document.getElementById('navbar-menu');
            navbarMenu.classList.toggle('hidden');
        }

        /**
         * Event listener for the navbar toggle button.
         */
        document.getElementById('navbar-toggle').addEventListener('click', toggleNavbarMenu);
    </script>

    <!-- Game Script -->
    <script type="text/babel">
        // Icon components
        const StarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="w-6 h-6 text-yellow-400" fill="currentColor" viewBox="0 0 24 24">
                <polygon points="12 17.27 18.18 21 15.89 13.47 21.64 8.63 13.81 8.13 12 1 10.19 8.13 2.36 8.63 8.11 13.47 5.82 21 12 17.27" />
            </svg>
        );

        const TrophyIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" className="w-6 h-6 text-purple-400" fill="currentColor" viewBox="0 0 24 24">
                <path d="M17 3h4v4c0 2.76-2.24 5-5 5h-1v2c0 1.85-1.28 3.42-3 3.86V21h6v2H5v-2h6v-3.14
                    c-1.72-.44-3-2.01-3-3.86v-2H7c-2.76 0-5-2.24-5-5V3h4
                    v4c0 .55.45 1 1 1h2V3h6v5h2c.55 0 1-.45 1-1V3z" />
            </svg>
        );

        // Main Game Component
        const WordRevealGame = () => {
            const [category, setCategory] = React.useState(null);
            const [currentWord, setCurrentWord] = React.useState('');
            const [revealLevel, setRevealLevel] = React.useState(0);
            const [score, setScore] = React.useState(0);
            const [choices, setChoices] = React.useState([]);
            const [gameState, setGameState] = React.useState('category'); // category, playing, success
            const [streak, setStreak] = React.useState(0);
            const [highScore, setHighScore] = React.useState(0);

            const categories = {
                animals: ['cat', 'dog', 'lion', 'elephant', 'monkey', 'panda', 'rabbit', 'bird', 'fish', 'penguin'],
                food: ['apple', 'banana', 'orange', 'cookie', 'cake', 'bread', 'carrot', 'tomato', 'corn', 'broccoli'],
                toys: ['toy_car', 'toy_robot', 'toy_train', 'toy_ball', 'toy_bike', 'toy_doll', 'toy_truck', 'toy_block', 'toy_kite', 'teddy_bear'],
                emotions: ['happy', 'sad', 'tired', 'excited', 'surprised']
            };

            const getRandomWords = (correct, count) => {
                const categoryWords = [...categories[category]];
                const words = [correct];
                while (words.length < count) {
                    const randomIndex = Math.floor(Math.random() * categoryWords.length);
                    const word = categoryWords[randomIndex];
                    if (!words.includes(word)) {
                        words.push(word);
                    }
                }
                return words.sort(() => Math.random() - 0.5);
            };

            const startNewRound = () => {
                const categoryWords = categories[category];
                const randomWord = categoryWords[Math.floor(Math.random() * categoryWords.length)];
                setCurrentWord(randomWord);
                setRevealLevel(0);
                setChoices(getRandomWords(randomWord, 4));

                // Start reveal timer
                const timer = setInterval(() => {
                    setRevealLevel(prev => {
                        if (prev >= 4) {
                            clearInterval(timer);
                            return prev;
                        }
                        return prev + 1;
                    });
                }, 2000);

                return () => clearInterval(timer);
            };

            const handleCategorySelect = (cat) => {
                setCategory(cat);
                setGameState('playing');
                setScore(0);
                setStreak(0);
                setHighScore(0);
            };

            const handleGuess = (guess) => {
                if (guess === currentWord) {
                    const points = Math.max(5 - revealLevel, 1) * 100;
                    setScore(prev => prev + points);
                    setStreak(prev => prev + 1);
                    setHighScore(prev => Math.max(prev, score + points));
                    startNewRound();
                } else {
                    setStreak(0);
                }
            };

            React.useEffect(() => {
                if (gameState === 'playing') {
                    startNewRound();
                }
            }, [gameState]);

            const renderCategorySelection = () => (
                <div className="space-y-6">
                    <h2 className="text-2xl font-bold text-center mb-6">Choose a Category</h2>
                    <div className="grid grid-cols-2 gap-4">
                        {Object.keys(categories).map((cat) => (
                            <button
                                key={cat}
                                onClick={() => handleCategorySelect(cat)}
                                className="p-6 text-lg capitalize bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                            >
                                {cat}
                            </button>
                        ))}
                    </div>
                </div>
            );

            const renderGame = () => (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <button
                            onClick={() => setGameState('category')}
                            className="text-blue-500 hover:text-blue-700"
                        >
                            &larr; Change Category
                        </button>
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-1">
                                <StarIcon />
                                <span className="font-bold">{score}</span>
                            </div>
                            <div className="flex items-center gap-1">
                                <TrophyIcon />
                                <span className="font-bold">×{streak}</span>
                            </div>
                        </div>
                    </div>

                    <div className="relative w-64 h-64 mx-auto">
                        <div className="absolute inset-0 grid grid-cols-2 grid-rows-2">
                            {[0, 1, 2, 3].map((quadrant) => (
                                <div
                                    key={quadrant}
                                    className={`transition-opacity duration-500 ${
                                        revealLevel > quadrant ? 'opacity-100' : 'opacity-0'
                                    }`}
                                >
                                    <img
                                        src={`images/${currentWord}.webp`}
                                        alt="Guess the word"
                                        className="w-full h-full object-cover"
                                        style={{
                                            clipPath: [
                                                'polygon(0 0, 50% 0, 50% 50%, 0 50%)',
                                                'polygon(50% 0, 100% 0, 100% 50%, 50% 50%)',
                                                'polygon(0 50%, 50% 50%, 50% 100%, 0 100%)',
                                                'polygon(50% 50%, 100% 50%, 100% 100%, 50% 100%)'
                                            ][quadrant]
                                        }}
                                    />
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                        {choices.map((choice, index) => (
                            <button
                                key={index}
                                onClick={() => handleGuess(choice)}
                                className="p-4 text-lg capitalize bg-white border border-gray-300 rounded-lg hover:bg-gray-100"
                            >
                                {choice.replace(/_/g, ' ')}
                            </button>
                        ))}
                    </div>

                    <div className="text-center text-sm text-gray-500">
                        Points remaining: {Math.max(5 - revealLevel, 1) * 100}
                    </div>
                </div>
            );

            return (
                <div className="w-full max-w-2xl mx-auto bg-white rounded-xl shadow-md p-6">
                    <h1 className="text-3xl font-bold text-center mb-8">Guess the Picture!</h1>
                    {gameState === 'category' && renderCategorySelection()}
                    {gameState === 'playing' && renderGame()}
                </div>
            );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WordRevealGame />);
    </script>
</body>
</html>
